{"version":3,"file":"backbone.service.js","sources":["backbone.service.js","/source/backbone.service.js"],"names":["global","factory","exports","module","require","define","amd","Backbone","Service","Radio","_","this","backbone_service","Model","extend","call","Channel","constructor","methods","each","method","name","once","_this","Promise","resolve","start","then","_this2","apply","_arguments","arguments","reply","comply"],"mappings":"AAAA,AAAC,CCAA,ADAA,SCAUA,CDAA,CCAQC,GACE,EDDJ,EAAE,OAAO,EAAE,GCCnBC,UAA0C,mBAAXC,QAAyBA,OAAOD,QAAUD,EAAQG,QAAQ,YAAaA,QAAQ,kBAAmBA,QAAQ,eAC9H,kBAAXC,SAAyBA,OAAOC,IAAMD,QAAQ,WAAY,iBAAkB,cAAeJ,GAClGD,EAAOO,SAASC,QAAUP,EAAQD,EAAOO,SAAUP,EAAOS,MAAOT,EAAOU,IACxEC,KAAM,SAAUJ,EAAUE,EAAOC,GAAK,YAEtC,IAAIE,GAAmBL,EAASM,MAAMC,OAAOC,KAAKN,EAAMO,SAMtDC,YAAW,SAACC,aACVR,GAAES,KAAKD,EAAS,SAACE,EAAQC,GAEV,UAATA,IACFD,EAASV,EAAEY,KAAKF,IAIlBG,EAAKF,GAAQD,EAGXA,EADW,UAATC,EACO,iCAEP,OAAOG,SAAQC,QAAQd,KAAKe,SAASC,KAAK,WACxCC,EAAKP,GAAIQ,MAACD,EAAAE,MAIL,WACP,MAAON,SAAQC,QAAQd,KAAKe,MAAKG,MAAVlB,KAAcoB,aAKzCR,EAAKS,MAAMX,EAAMD,GACjBG,EAAKU,OAAOZ,EAAMD,MAQtBM,MAAK,cAGP,OAAOd;AD/CP,SAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,MAAM,KAAK,WAAW,GAAG,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,gBAAgB,CAAC,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC,GAC9J,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,UAAU,EAAE,gBAAgB,EAAE,YAAY,CAAC,EAAE,OAAO,CAAC,GAC1G,MAAM,CAAC,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC,CAAA;CAC3E,CAAA,CAAC,IAAI,EAAE,UAAU,QAAQ,EAAE,KAAK,EAAE,CAAC,EAAE;AAAE,cAAY,CAAC;;AAEnD,MAAI,gBAAgB,GAAG,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;;;;;;AAM/D,eAAW,EAAA,qBAAC,OAAO,EAAE;;;AACnB,OAAC,CAAC,IAAI,CAAC,OAAO,EAAE,UAAC,MAAM,EAAE,IAAI,EAAK;;AAEhC,YAAI,IAAI,KAAK,OAAO,EAAE;AACpB,gBAAM,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACzB;;;AAGD,cAAK,IAAI,CAAC,GAAG,MAAM,CAAC;;AAEpB,YAAI,IAAI,KAAK,OAAO,EAAE;AACpB,gBAAM,GAAG,YAAW;;;;;AAElB,mBAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,CAAC,YAAM;AAC9C,qBAAK,IAAI,OAAC,oBAAc,CAAC;aAC1B,CAAC,CAAC;WACJ,CAAC;SACH,MAAM;AACL,gBAAM,GAAG,YAAW;AAClB,mBAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,MAAA,CAAV,IAAI,EAAU,SAAS,CAAC,CAAC,CAAC;WAClD,CAAC;SACH;;;AAGD,cAAK,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;AACzB,cAAK,MAAM,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;OAC3B,CAAC,CAAC;KACJ;;;;;;AAMD,SAAK,EAAA,iBAAG,EAAE;GACX,CAAC,CAAC;;AAEH,SAAO,gBAAgB,CAAC;CAEzB,CAAC,CAAE","sourceRoot":"/source/","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone'), require('backbone.radio'), require('underscore')) :\n  typeof define === 'function' && define.amd ? define(['backbone', 'backbone.radio', 'underscore'], factory) :\n  global.Backbone.Service = factory(global.Backbone, global.Radio, global._)\n}(this, function (Backbone, Radio, _) { 'use strict';\n\n  var backbone_service = Backbone.Model.extend.call(Radio.Channel, {\n\n    /**\n     * @constructs Service\n     * @param {Object} methods\n     */\n    constructor(methods) {\n      _.each(methods, (method, name) => {\n        // start method should only ever be called once.\n        if (name === 'start') {\n          method = _.once(method);\n        }\n\n        // Add the method directly to the service object.\n        this[name] = method;\n\n        if (name !== 'start') {\n          method = function() {\n            // Ensure service is always started.\n            return Promise.resolve(this.start()).then(() => {\n              this[name](...arguments);\n            });\n          };\n        } else {\n          method = function() {\n            return Promise.resolve(this.start(...arguments));\n          };\n        }\n\n        // Register as both a Request and Command for convenience.\n        this.reply(name, method);\n        this.comply(name, method);\n      });\n    },\n\n    /**\n     * @abstract\n     * @method start\n     */\n    start() {}\n  });\n\n  return backbone_service;\n\n}));\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone'), require('backbone.radio'), require('underscore')) :\n  typeof define === 'function' && define.amd ? define(['backbone', 'backbone.radio', 'underscore'], factory) :\n  global.Backbone.Service = factory(global.Backbone, global.Radio, global._)\n}(this, function (Backbone, Radio, _) { 'use strict';\n\n  var backbone_service = Backbone.Model.extend.call(Radio.Channel, {\n\n    /**\n     * @constructs Service\n     * @param {Object} methods\n     */\n    constructor(methods) {\n      _.each(methods, (method, name) => {\n        // start method should only ever be called once.\n        if (name === 'start') {\n          method = _.once(method);\n        }\n\n        // Add the method directly to the service object.\n        this[name] = method;\n\n        if (name !== 'start') {\n          method = function() {\n            // Ensure service is always started.\n            return Promise.resolve(this.start()).then(() => {\n              this[name](...arguments);\n            });\n          };\n        } else {\n          method = function() {\n            return Promise.resolve(this.start(...arguments));\n          };\n        }\n\n        // Register as both a Request and Command for convenience.\n        this.reply(name, method);\n        this.comply(name, method);\n      });\n    },\n\n    /**\n     * @abstract\n     * @method start\n     */\n    start() {}\n  });\n\n  return backbone_service;\n\n}));\n"]}