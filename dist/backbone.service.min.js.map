{"version":3,"file":"backbone.service.js","sources":["backbone.service.js","/source/backbone.service.js"],"names":["global","factory","exports","module","require","define","amd","Backbone","Service","Radio","_","PromisePolyfill","this","resolved","Promise","resolve","backbone_service","Model","extend","call","Channel","constructor","props","each","value","name","_this","isFunction","request","then","_this2","apply","_arguments","once","start","reply","comply","initialize"],"mappings":"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","sourceRoot":"/source/","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone'), require('backbone.radio'), require('underscore'), require('es6-promise')) :\n  typeof define === 'function' && define.amd ? define(['backbone', 'backbone.radio', 'underscore', 'es6-promise'], factory) :\n  global.Backbone.Service = factory(global.Backbone, global.Radio, global._, global.PromisePolyfill)\n}(this, function (Backbone, Radio, _, PromisePolyfill) { 'use strict';\n\n  const resolved = PromisePolyfill.Promise.resolve();\n\n  /**\n   * @class Service\n   */\n  var backbone_service = Backbone.Model.extend.call(Radio.Channel, {\n\n    /**\n     * @constructs Service\n     * @param {Object} methods\n     */\n    constructor(props) {\n      _.each(props, (value, name) => {\n        // Add the property directly to the service object.\n        this[name] = value;\n\n        // Leave non-functions and initialize() as is.\n        if (!_.isFunction(value) || name === 'initialize') {\n          return;\n        }\n\n        if (name !== 'start') {\n          value = function() {\n            // Ensure service is always started.\n            return this.request('start').then(() => this[name](...arguments));\n          };\n        } else {\n          // start method should only ever be called once.\n          value = _.once(() => resolved.then(() => this.start()));\n        }\n\n        // Register as both a Request and Command for convenience.\n        this.reply(name, value);\n        this.comply(name, value);\n      });\n    },\n\n    /**\n     * @abstract\n     * @method initialize\n     */\n    initialize() {},\n\n    /**\n     * @abstract\n     * @method start\n     */\n    start() {}\n  });\n\n  return backbone_service;\n\n}));\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone'), require('backbone.radio'), require('underscore'), require('es6-promise')) :\n  typeof define === 'function' && define.amd ? define(['backbone', 'backbone.radio', 'underscore', 'es6-promise'], factory) :\n  global.Backbone.Service = factory(global.Backbone, global.Radio, global._, global.PromisePolyfill)\n}(this, function (Backbone, Radio, _, PromisePolyfill) { 'use strict';\n\n  const resolved = PromisePolyfill.Promise.resolve();\n\n  /**\n   * @class Service\n   */\n  var backbone_service = Backbone.Model.extend.call(Radio.Channel, {\n\n    /**\n     * @constructs Service\n     * @param {Object} methods\n     */\n    constructor(props) {\n      _.each(props, (value, name) => {\n        // Add the property directly to the service object.\n        this[name] = value;\n\n        // Leave non-functions and initialize() as is.\n        if (!_.isFunction(value) || name === 'initialize') {\n          return;\n        }\n\n        if (name !== 'start') {\n          value = function() {\n            // Ensure service is always started.\n            return this.request('start').then(() => this[name](...arguments));\n          };\n        } else {\n          // start method should only ever be called once.\n          value = _.once(() => resolved.then(() => this.start()));\n        }\n\n        // Register as both a Request and Command for convenience.\n        this.reply(name, value);\n        this.comply(name, value);\n      });\n    },\n\n    /**\n     * @abstract\n     * @method initialize\n     */\n    initialize() {},\n\n    /**\n     * @abstract\n     * @method start\n     */\n    start() {}\n  });\n\n  return backbone_service;\n\n}));\n"]}